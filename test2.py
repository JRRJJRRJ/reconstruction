import numpy as np
import random

# 示例 merged_results
merged_results = {
     ('11', ('10', '47')): np.float64(0.0016204009423288453),
     ('11', ('10', '79')): np.float64(0.007728003235301896),
     ('11', ('12', '54')): np.float64(0.0020628229113116366),
     ('11', ('15', '54')): np.float64(0.025900385150448825),
     ('11', ('15', '6')): np.float64(0.00978925570381601),
     ('11', ('19', '85')): np.float64(-0.02598384684689438),
     ('11', ('24', '70')): np.float64(-0.005296020957541321),
     ('11', ('34', '85')): np.float64(-0.009959376229056512),
     ('11', ('45', '54')): np.float64(0.009385070036817735),
     ('11', ('54', '7')): np.float64(0.0038405601554875267),
     ('11', ('54', '8')): np.float64(0.005209312719691317),
     ('11', ('56', '58')): np.float64(-0.01419885289657617),
     ('11', ('56', '63')): np.float64(-0.010176549940472722),
     ('11', ('56', '85')): np.float64(-0.006038835608811025),
     ('11', ('75', '79')): np.float64(0.0006346760085634157),
     ('13', ('10', '71')): np.float64(-0.007290701030288397),
     ('13', ('12', '62')): np.float64(0.0019327128879520722),
     ('13', ('15', '44')): np.float64(0.005690493991190777),
     ('13', ('15', '56')): np.float64(0.00024814488117914446),
     ('13', ('15', '62')): np.float64(0.02044116619729001),
     ('13', ('16', '35')): np.float64(-0.006878525016573351),
     ('13', ('16', '68')): np.float64(-0.03421303518697615),
     ('13', ('16', '71')): np.float64(-0.017660033261055832),
     ('13', ('25', '76')): np.float64(0.008344818022567526),
     ('13', ('28', '71')): np.float64(-0.01811860676671792),
     ('13', ('34', '55')): np.float64(0.0034935728715854413),
     ('13', ('55', '77')): np.float64(0.005738646490756103),
     ('13', ('59', '62')): np.float64(0.0007321532768109888),
     ('16', ('10', '15')): np.float64(-0.014673557023463712),
     ('16', ('12', '19')): np.float64(-0.005013907313077169),
     ('16', ('12', '24')): np.float64(-0.0015729542987047412),
     ('16', ('12', '58')): np.float64(-0.005701314492181474),
     ('16', ('12', '73')): np.float64(-0.00799538734805585),
     ('16', ('13', '23')): np.float64(0.006827337485936754),
     ('16', ('13', '53')): np.float64(0.025101250518012097),
     ('16', ('13', '64')): np.float64(0.030491004813541216),
     ('16', ('15', '70')): np.float64(-0.001931350132672452),
     ('16', ('15', '8')): np.float64(-0.012753168821924538),
     ('16', ('20', '54')): np.float64(-0.015562316945950054),
     ('16', ('23', '56')): np.float64(0.00938692236981023),
     ('16', ('23', '64')): np.float64(0.003958800666621981),
     ('16', ('24', '62')): np.float64(-0.007007212622562845),
     ('16', ('33', '79')): np.float64(-0.001024583766241254),
     ('16', ('35', '37')): np.float64(0.003855475607986759),
     ('16', ('41', '54')): np.float64(-0.00903259851506341),
     ('16', ('41', '68')): np.float64(-0.0014066896146195727),
     ('16', ('47', '64')): np.float64(0.007285933760454498),
     ('16', ('60', '62')): np.float64(-0.02450522628215367),
     ('16', ('62', '63')): np.float64(-1.1214615326404252e-05),
     ('18', ('13', '34')): np.float64(-0.010127308114468575),
     ('18', ('19', '79')): np.float64(0.021629252304510342),
     ('18', ('23', '51')): np.float64(0.004797514527068372),
     ('18', ('23', '6')): np.float64(0.025725037850515803),
     ('18', ('25', '62')): np.float64(0.0029487099167807163),
     ('18', ('27', '53')): np.float64(-0.0042887189376491774),
     ('18', ('34', '53')): np.float64(-0.007206678779337092),
     ('18', ('34', '70')): np.float64(-0.01227522782320115),
     ('18', ('34', '85')): np.float64(-0.004321416065727581),
     ('18', ('35', '60')): np.float64(-0.002658694761581691),
     ('18', ('35', '68')): np.float64(-0.003453086818292023),
     ('18', ('41', '64')): np.float64(0.01539650388045638),
     ('18', ('44', '62')): np.float64(0.004228028428954484),
     ('18', ('44', '65')): np.float64(0.002419283446137026),
     ('18', ('47', '76')): np.float64(0.0038537567196087054),
     ('18', ('47', '79')): np.float64(0.016260001435448042),
     ('18', ('50', '76')): np.float64(0.0017425606989799455),
     ('18', ('50', '79')): np.float64(0.0012717391680534922),
     ('18', ('52', '60')): np.float64(-0.007393375480946317),
     ('18', ('6', '64')): np.float64(0.0017431853838793718),
     ('18', ('60', '7')): np.float64(-0.023157709555905962),
     ('18', ('60', '71')): np.float64(-0.01168086419535304),
     ('18', ('65', '79')): np.float64(0.01012788382091942),
     ('18', ('77', '79')): np.float64(0.01764279865067666),
     ('20', ('10', '18')): np.float64(-0.0028774009343648013),
     ('20', ('13', '59')): np.float64(-0.007686752311877139),
     ('20', ('15', '51')): np.float64(0.004110762379499133),
     ('20', ('16', '53')): np.float64(0.003547472211201971),
     ('20', ('25', '44')): np.float64(0.020428413987553958),
     ('20', ('25', '51')): np.float64(0.035879357681671366),
     ('20', ('25', '60')): np.float64(0.0017958583425639967),
     ('20', ('27', '34')): np.float64(-0.007561968226662058),
     ('20', ('33', '85')): np.float64(-0.013580172545855577),
     ('20', ('34', '65')): np.float64(-0.018554120217499127),
     ('20', ('41', '60')): np.float64(0.0027852864762675103),
     ('20', ('44', '60')): np.float64(0.0036140270089953194),
     ('20', ('50', '51')): np.float64(0.0010407474687964796),
     ('20', ('51', '60')): np.float64(0.024119021206642968),
     ('20', ('73', '79')): np.float64(-0.009972800335849697),
     ('34', ('13', '56')): np.float64(-0.00020415967409263664),
     ('34', ('15', '25')): np.float64(-0.013187613630872584),
     ('34', ('15', '63')): np.float64(-0.01104360833719123),
     ('34', ('15', '64')): np.float64(-0.006580293973894369),
     ('34', ('15', '71')): np.float64(-0.011134370253615645),
     ('34', ('16', '6')): np.float64(0.003893587215325256),
     ('34', ('18', '55')): np.float64(0.0028917039695213),
     ('34', ('18', '60')): np.float64(0.01260724207561327),
     ('34', ('20', '24')): np.float64(0.009285347985872818),
     ('34', ('20', '85')): np.float64(0.008547774596947742),
     ('34', ('23', '63')): np.float64(-2.513484119215683e-05),
     ('34', ('28', '64')): np.float64(-0.005525787967962318),
     ('34', ('58', '6')): np.float64(0.01155277788745135),
     ('34', ('60', '85')): np.float64(0.019563035875742357),
     ('34', ('76', '85')): np.float64(0.04746888016025076),
     ('37', ('15', '35')): np.float64(-0.00794819865254232),
     ('37', ('16', '25')): np.float64(-0.0010409866282728624),
     ('37', ('18', '7')): np.float64(-0.01402470053435931),
     ('37', ('23', '56')): np.float64(-0.0001401971688575165),
     ('37', ('35', '65')): np.float64(-0.004761856438649483),
     ('37', ('44', '7')): np.float64(-0.006685755418417193),
     ('37', ('50', '7')): np.float64(-0.001689505852466241),
     ('37', ('51', '79')): np.float64(0.0037705272118153245),
     ('37', ('58', '79')): np.float64(0.04572877183706076),
     ('37', ('62', '7')): np.float64(-0.0028507956493065765),
     ('37', ('7', '85')): np.float64(-0.00015907501015471271),
     ('37', ('71', '77')): np.float64(-0.005056642819321437),
     ('37', ('76', '79')): np.float64(0.007296319756783607),
     ('44', ('10', '19')): np.float64(0.00012099769769596908),
     ('44', ('10', '68')): np.float64(4.1389383249646746e-05),
     ('44', ('11', '60')): np.float64(-0.0015592482148745971),
     ('44', ('12', '35')): np.float64(-0.009242967654980056),
     ('44', ('12', '60')): np.float64(-0.017496636345751364),
     ('44', ('13', '60')): np.float64(-0.008474253595663249),
     ('44', ('18', '50')): np.float64(-0.004994946195424087),
     ('44', ('20', '8')): np.float64(-0.004118675909556317),
     ('44', ('23', '60')): np.float64(-0.013450565417450542),
     ('44', ('27', '68')): np.float64(0.0023200898053375007),
     ('44', ('28', '54')): np.float64(0.0027271630184241874),
     ('44', ('28', '79')): np.float64(0.0025789897621600047),
     ('44', ('50', '60')): np.float64(-0.0010293229736349839),
     ('44', ('54', '7')): np.float64(0.006015177687621238),
     ('44', ('60', '76')): np.float64(-0.010306397474441483),
     ('44', ('60', '8')): np.float64(-0.006662025030974798),
     ('52', ('15', '37')): np.float64(-0.009032791880500421),
     ('52', ('15', '6')): np.float64(-0.04292449089352716),
     ('52', ('19', '25')): np.float64(0.0008193854133706312),
     ('52', ('19', '62')): np.float64(0.00034808284655327647),
     ('52', ('19', '63')): np.float64(0.0029361402673932506),
     ('52', ('19', '65')): np.float64(0.007665426792116016),
     ('52', ('24', '7')): np.float64(-0.006062346427728962),
     ('52', ('24', '75')): np.float64(-0.0048582908270650565),
     ('52', ('25', '65')): np.float64(0.0004816774438019453),
     ('52', ('25', '76')): np.float64(0.012791410318562414),
     ('52', ('33', '65')): np.float64(0.00045832260477713776),
     ('52', ('34', '6')): np.float64(-0.0006492518336026024),
     ('52', ('35', '75')): np.float64(-0.0068945931159622885),
     ('52', ('65', '76')): np.float64(0.00039952161217973986),
     ('60', ('16', '64')): np.float64(0.024183887712809726),
     ('60', ('18', '19')): np.float64(0.0073985710148045765),
     ('60', ('18', '44')): np.float64(0.039730161366613746),
     ('60', ('20', '34')): np.float64(-0.02884511682256069),
     ('60', ('20', '63')): np.float64(-0.015516630273325402),
     ('60', ('20', '76')): np.float64(-0.005172146334984883),
     ('60', ('29', '63')): np.float64(-0.00016892728263165214),
     ('60', ('33', '44')): np.float64(0.0018137352893634025),
     ('60', ('34', '35')): np.float64(-0.003152965338779776),
     ('60', ('44', '52')): np.float64(0.001434396184900733),
     ('60', ('44', '55')): np.float64(0.011763068842528483),
     ('60', ('44', '62')): np.float64(0.015287134524450957),
     ('60', ('47', '65')): np.float64(-0.008696692184075863),
     ('60', ('63', '71')): np.float64(-0.005094139136569914),
     ('60', ('70', '76')): np.float64(-0.0016465004676682912),
     ('62', ('12', '16')): np.float64(0.03802913827545634),
     ('62', ('12', '28')): np.float64(0.0019129531482198461),
     ('62', ('12', '35')): np.float64(0.017738398239821755),
     ('62', ('12', '71')): np.float64(0.0034341991000565886),
     ('62', ('12', '76')): np.float64(0.002521108831577299),
     ('62', ('13', '18')): np.float64(-0.0005290584900847743),
     ('62', ('13', '58')): np.float64(-0.006649567874155797),
     ('62', ('13', '73')): np.float64(-0.014462708213637447),
     ('62', ('18', '51')): np.float64(-0.009404503745093395),
     ('62', ('23', '24')): np.float64(-0.005248347515569286),
     ('62', ('24', '64')): np.float64(-0.001194147260858625),
     ('62', ('25', '28')): np.float64(0.0027927986442696684),
     ('62', ('28', '54')): np.float64(0.012232985729896829),
     ('62', ('41', '59')): np.float64(-0.0007634517186487564),
     ('62', ('45', '70')): np.float64(-0.007364983865689355),
     ('62', ('45', '77')): np.float64(-0.010018253232922688),
     ('62', ('51', '59')): np.float64(-0.005686416455868964),
     ('62', ('65', '68')): np.float64(0.008756383686943333),
     ('70', ('11', '7')): np.float64(0.0022096007831584243),
     ('70', ('15', '50')): np.float64(0.014851632410353824),
     ('70', ('19', '73')): np.float64(-0.0015862871645003465),
     ('70', ('44', '75')): np.float64(0.013111409753383334),
     ('70', ('45', '75')): np.float64(0.015453948080933772),
     ('70', ('50', '64')): np.float64(0.00600677613991686),
     ('70', ('50', '75')): np.float64(0.013125899264131794),
     ('70', ('51', '75')): np.float64(0.0047790962102230074),
     ('70', ('55', '75')): np.float64(0.009347149140830227),
     ('70', ('60', '75')): np.float64(0.00457556244614823),
     ('70', ('65', '75')): np.float64(0.013316168241709534),
     ('70', ('71', '73')): np.float64(-0.01823942311775087),
     ('70', ('75', '77')): np.float64(0.004542462285957046),
     ('75', ('11', '70')): np.float64(-0.01595243956195598),
     ('75', ('45', '70')): np.float64(-0.017133109019030545),
     ('75', ('51', '70')): np.float64(-0.021785499751353323),
     ('75', ('52', '54')): np.float64(0.005858700399826234),
     ('75', ('54', '7')): np.float64(0.011561513948802575),
     ('75', ('55', '70')): np.float64(-0.001887446045459469),
     ('75', ('56', '70')): np.float64(-0.0035382767643910764),
     ('75', ('62', '70')): np.float64(-0.00048066195639670615),
     ('75', ('70', '83')): np.float64(-0.00914099908674281),
     ('79', ('11', '37')): np.float64(-0.014938254200359968),
     ('79', ('15', '16')): np.float64(0.0036142354019450414),
     ('79', ('15', '20')): np.float64(0.00801810031337283),
     ('79', ('18', '54')): np.float64(-0.006170955688640843),
     ('79', ('18', '62')): np.float64(-0.005165361501743745),
     ('79', ('18', '71')): np.float64(-0.02320189209737119),
     ('79', ('18', '76')): np.float64(-0.022596690236102532),
     ('79', ('19', '53')): np.float64(0.007041278818707944),
     ('79', ('19', '59')): np.float64(0.009625833740003496),
     ('79', ('29', '37')): np.float64(-0.0016094201288119807),
     ('79', ('35', '37')): np.float64(-0.02434895594091861),
     ('79', ('37', '52')): np.float64(-0.012601727425718483),
     ('79', ('37', '71')): np.float64(-0.0014630548401074058),
     ('79', ('37', '77')): np.float64(-0.0007678414945134926),
     ('85', '34'): np.float64(-0.015760465980044595),
     ('85', ('10', '25')): np.float64(0.0011716133225302646),
     ('85', ('10', '44')): np.float64(0.0061602725915373404),
     ('85', ('10', '47')): np.float64(0.013049693981634986),
     ('85', ('11', '15')): np.float64(0.009475336164622284),
     ('85', ('11', '35')): np.float64(0.003907086476666625),
     ('85', ('11', '7')): np.float64(0.004458336740614865),
     ('85', ('12', '34')): np.float64(-0.00948940794273704),
     ('85', ('15', '27')): np.float64(0.006739328764110469),
     ('85', ('34', '56')): np.float64(-0.019126475961750333),
     ('85', ('34', '65')): np.float64(-0.008781010931824993),
     ('85', ('51', '55')): np.float64(0.004254453624385108),
     ('85', ('54', '68')): np.float64(-0.006610640751383676),
     ('85', ('55', '63')): np.float64(0.005647818448814432),
     ('85', ('55', '73')): np.float64(0.0002421441743220765),
     ('85', ('68', '8')): np.float64(-0.005466524743262284),
     ('32', '66'): np.float64(-0.006162995726974278),
     ('32', '9'): np.float64(0.007984632653352872),
     ('32', ('66', '84')): np.float64(-0.010158678782246373),
     ('32', ('74', '84')): np.float64(-0.008993040234846688),
     ('84', '66'): np.float64(-0.007802214662996688),
     ('84', ('32', '9')): np.float64(0.006894028510741931),
     ('84', ('66', '74')): np.float64(-0.015800227412512354),
     ('57', ('21', '36')): np.float64(0.004857121909539009),
     ('57', ('21', '82')): np.float64(0.0014449270024622515),
     ('57', ('22', '48')): np.float64(-0.004228424115100829),
     ('57', ('22', '61')): np.float64(-0.009269708125330787),
     ('57', ('36', '82')): np.float64(0.028020407639845268),
     ('57', ('38', '4')): np.float64(-0.012080475079058208),
     ('57', ('38', '80')): np.float64(0.009129130150511228),
     ('1', ('14', '2')): np.float64(0.01055069714705184),
     ('1', ('26', '39')): np.float64(0.0019018949686831885),
     ('1', ('26', '49')): np.float64(0.01859570030961242),
     ('1', ('31', '67')): np.float64(-0.0022780521122988517),
     ('1', ('40', '43')): np.float64(-0.0034506826847410027),
     ('1', ('40', '5')): np.float64(0.02010841069763347),
     ('1', ('42', '43')): np.float64(-0.0006463380965772036),
     ('1', ('42', '67')): np.float64(-0.0018975070760004354),
     ('1', ('43', '67')): np.float64(-0.009826447829947137),
     ('39', ('1', '31')): np.float64(-0.00781932808717875),
     ('39', ('14', '40')): np.float64(0.019752840308923783),
     ('39', ('14', '5')): np.float64(0.009362942826994774),
     ('39', ('2', '31')): np.float64(-0.007795834988402669),
     ('39', ('2', '67')): np.float64(-0.002698177347754493),
     ('39', ('40', '43')): np.float64(0.01030421935434993),
     ('39', ('49', '5')): np.float64(0.021178205580448077),
     ('42', ('1', '31')): np.float64(0.007932291438497953),
     ('42', ('2', '49')): np.float64(-0.003319787634918061),
     ('42', ('26', '43')): np.float64(-0.003014391120262762),
     ('42', ('26', '49')): np.float64(-0.0030460875966048747),
     ('42', ('26', '5')): np.float64(-0.008676643683342868),
     ('42', ('40', '67')): np.float64(0.03119012995892949),
     ('42', ('49', '5')): np.float64(-0.017283714266594336),
     ('17', ('30', '69')): np.float64(-0.020836568520044677),
     ('72', ('3', '69')): np.float64(-0.028242884299890688),
     ('72', ('30', '78')): np.float64(0.00636435769532506),
     ('28', ('24', '65')): np.float64(0.03214000405586369),
     ('28', ('32', '57')): np.float64(0.004803099160991478),
     ('28', ('45', '57')): np.float64(0.014260155188621866),
     ('28', ('14', '68')): np.float64(-0.015632765856527446),
     ('28', ('14', '52')): np.float64(-0.005376107328810026),
     ('28', ('14', '53')): np.float64(-0.0026945282753567017),
     ('28', ('21', '53')): np.float64(-0.00013749304466800655),
     ('28', ('38', '53')): np.float64(-0.012998468442639709),
     ('28', ('54', '62')): np.float64(-0.01810375040911747),
     ('28', ('14', '54')): np.float64(-0.001132964260689096),
     ('28', ('54', '77')): np.float64(-0.001064607134019789),
     ('28', ('14', '82')): np.float64(-0.006844714719072647),
     ('28', ('17', '21')): np.float64(-0.009167144800810842),
     ('28', ('21', '38')): np.float64(-0.0218680648805935),
     ('28', ('32', '73')): np.float64(0.0032522798626428984),
     ('28', ('72', '73')): np.float64(0.005623152475318821),
     ('28', ('45', '72')): np.float64(0.0038848792590001732),
     ('51', ('20', '40')): np.float64(-0.021579963649939894),
     ('51', ('20', '77')): np.float64(-0.004092319326568438),
     ('51', ('20', '61')): np.float64(-0.002427653478943117),
     ('85', ('68', '82')): np.float64(-0.012663139480147703),
     ('85', ('21', '34')): np.float64(-0.02618763270592112),
     ('85', ('17', '34')): np.float64(-0.0008902272729390074),
     ('85', ('34', '42')): np.float64(-0.013091324591861986),
     ('85', ('34', '61')): np.float64(-0.007998129724503863)

     }


# 1. 转换键为字符串格式，并存入集合（自动去重）
lines_set = set()

for key in merged_results:
    node = key[0]
    others = key[1]
    full_list = [node] + list(others)
    line = ' '.join(full_list)
    lines_set.add(line)

# 2. 打乱顺序
all_lines = list(lines_set)
random.shuffle(all_lines)

# 3. 写入 real.txt（初步写入）
with open("real.txt", "w") as f:
    for line in all_lines:
        f.write(line + "\n")

# 4. 抽取30%的行，打乱除第一列外的其余字段顺序
num_sample = int(len(all_lines) * 0.3)
sampled_lines = random.sample(all_lines, num_sample)

# 构造替换后的行
modified_lines = []
for line in sampled_lines:
    parts = line.strip().split()
    first = parts[0]
    rest = parts[1:]
    random.shuffle(rest)
    modified_line = ' '.join([first] + rest)
    modified_lines.append(modified_line)

# 替换原来的 sampled 行
final_lines = list(set(all_lines) - set(sampled_lines)) + modified_lines
random.shuffle(final_lines)  # 最终打乱整体顺序

# 5. 覆盖写入 real.txt
with open("hyT1000.txt", "w") as f:
    for line in final_lines:
        f.write(line + "\n")

from index.F1_score import F1

precision, recall, f1, metrics = F1("RealNet_data/hypertext2009/T=1000/compare", merged_results)

